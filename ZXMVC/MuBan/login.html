<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title></title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="robots" content="all,follow">
    <script src="../Scripts/bootstrap.js"></script>
    <link rel="stylesheet" href="vendor/bootstrap/css/bootstrap.min.css">
    <link rel="stylesheet" href="vendor/font-awesome/css/font-awesome.min.css">
    <link rel="stylesheet" href="css/font.css">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Muli:300,400,700">
    <link rel="stylesheet" href="css/style.default.css" id="theme-stylesheet">
    <link rel="stylesheet" href="css/custom.css">
    <link rel="shortcut icon" href="img/favicon.ico">
    <script src="../Scripts/jquery-3.4.1.js"></script>
    <link type="text/css" rel="stylesheet" href="style.css">
    <link href="../imgVer/style.css" rel="stylesheet" />
    <script src="../imgVer/jquery.min.js"></script>
    <script src="../imgVer/img_ver.js"></script>
    <style>
        .bxs-row {
            margin-bottom: 12px;
        }

        .logo-box {
            width: 404px;
            margin: 150px auto;
            border: 1px solid #e5e5e5;
            border-radius: 4px;
            box-shadow: 0 4px 18px rgba(0,0,0,0.2);
            position: relative;
            overflow: hidden;
            height: 360px;
        }

        .login {
            position: absolute;
            width: 320px;
            left: 0;
            top: 0;
            padding: 42px 42px 36px;
            transition: all 0.8s;
        }


        .submit:hover {
            background-color: #005ea6;
        }

        .verBox {
            position: absolute;
            width: 100%;
            text-align: center;
            left: 420px;
            top: 0;
            opacity: 1;
            transition: all 0.8s;
            padding-top: 85px;
        }

        .err {
            margin: 12px 0 0;
            line-height: 12px;
            height: 12px;
            font-size: 12px;
            color: red;
        }
    </style>
</head>
<body>
    <div class="login-page">
        <div class="container d-flex align-items-center">
            <div class="form-holder has-shadow">
                <div class="row">
                    <!-- Logo & Information Panel-->
                    <div class="col-lg-6">
                        <div class="info d-flex align-items-center">
                            <div class="content">
                                <div class="logo">
                                    <h1>智信车贷管理系统</h1>
                                </div>
                                <p>为您提供快速高效的服务</p>
                            </div>
                        </div>
                    </div>
                    <div class="col-lg-6">
                        <div class="form d-flex align-items-center">
                            <div class="content">
                                <form method="get" class="form-validate mb-4">
                                    <div class="form-group">
                                        <input id="login-username" type="text" name="loginUsername" class="input-material" onblur="Change1()"><span id="name" style="color:orangered">请正确输入您的用户名！（2-6位汉字字母数字）</span>
                                        <label for="login-username" class="label-material">用户名</label>
                                    </div>
                                    <div class="form-group">
                                        <input id="login-password" type="password" name="loginPassword" class="input-material" onblur="Change2()"><span id="pwd" style="color:orangered">请正确输入您的密码！(字母开头6--18位)</span>
                                        <label for="login-password" class="label-material">密码</label>
                                    </div>
                                    <button type="button" class="btn btn-primary" onclick="Login()">登录</button><br /><br />
                                </form><a href="#" class="forgot-pass">忘记了密码？ 去找回</a><br><small>还没有账号?去注册 </small><a href="register.html" class="signup">注册</a>
                            </div>
                        </div>
                        <div class="verBox" id="yzImg">
                            <div id="imgVer" style="display:inline-block;"></div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="copyrights text-center">
            <p>Design by <a class="external">GroupOne</a></p>
            <!-- Please do not remove the backlink to us unless you support further theme's development at https://bootstrapious.com/donate. It is part of the license conditions. Thank you for understanding :)-->
        </div>
    </div>
    <!-- JavaScript files-->
    <script src="vendor/jquery/jquery.min.js"></script>
    <script src="vendor/popper.js/umd/popper.min.js"></script>
    <script src="vendor/bootstrap/js/bootstrap.min.js"></script>
    <script src="vendor/jquery.cookie/jquery.cookie.js"></script>
    <script src="vendor/chart.js/Chart.min.js"></script>
    <script src="vendor/jquery-validation/jquery.validate.min.js"></script>
    <script src="js/front.js"></script>
</body>
</html>


<script>
    $(function () {
        document.getElementById("name").style.display = "none";
        document.getElementById("pwd").style.display = "none";
    })
    //密码正则验证
    var regName = /^[a-zA-Z]\w{5,17}$/;

    //用户名正则验证+判重
    var re = /^[\u4E00-\u9FA5A-Za-z0-9]+$/;

    function Change1() {
        var name = $("#login-username").val();
        if (re.test(name) && name.length >= 2 && name.length <= 6) {
            document.getElementById("name").style.display = "none";
        }
        else {
            document.getElementById("name").style.display = "block";
        }
    }
    function Change2() {
        var pwd = $("#login-password").val();


        if (regName.test(pwd)) {
            document.getElementById("pwd").style.display = "none";
        }
        else {
            document.getElementById("pwd").style.display = "block";
        }
    }

    function Login() {
        var name = $("#login-username").val();
        var pwd = $("#login-password").val();


        if (regName.test(pwd) && re.test(name) && name.length >= 2 && name.length <= 6) {
            $(".verBox").css({
                "left": "0",
                "opacity": "1"
            });
            imgVer({
                el: '$("#imgVer")',
                width: '260',
                height: '116',
                img: [
                    '../imgVer/images/ver-4.png',
                    '../imgVer/images/ver-5.png',
                    '../imgVer/images/ver-6.png',
                    '../imgVer/images/ver-7.png',
                    '../imgVer/images/ver-8.png'
                ],
                success: function () {
                    $.ajax({
                        url: "https://localhost:44356/api/ZXLoan/Login",
                        type: "post",
                        data: { Uname: name, Upwd: pwd },
                        success: function (d) {
                            if (d > 0) {
                                //根据不同的角色显示不同的页面  1管理员  2审核员  3
                                if (d == 1) {
                                    addCookie("uName", name, 3)
                                    location.href = "index.html";
                                }
                                if (d == 2) {
                                    addCookie("SName", name, 3)
                                    location.href = "charts.html";
                                }
                                if (d == 3) {
                                    location.href = "";
                                }
                            }
                            else {
                                alert("登录失败！");
                                $(".verBox").css({
                                    "position": "absolute",
                                    "width": "100 %",
                                    "text- align": "center",
                                    "left": "420px",
                                    "top": "0",
                                    "opacity": "1",
                                    "transition": "all 0.8s",
                                    "padding - top": "85px",
                                });
                            }
                        }
                    })
                },
            });
        }
        else if (!regName.test(pwd) && !re.test(name) && name.length <= 2 || name.length >= 6) {
            document.getElementById("name").style.display = "block";
            document.getElementById("pwd").style.display = "block";
        }
        else if (!re.test(name)) {
            document.getElementById("name").style.display = "block";
        }
        else if (!regName.test(pwd)) {
            document.getElementById("pwd").style.display = "block";
        }
    }

    function addCookie(name, value, expiresHours) {
        var cookieString = name + "=" + escape(value);
        //判断是否设置过期时间 
        if (expiresHours > 0) {
            var date = new Date();
            date.setTime(date.getTime + expiresHours * 3600 * 1000);
            cookieString = cookieString + "; expires=" + date.toGMTString(); 
        }
        document.cookie = cookieString;
    }

</script>